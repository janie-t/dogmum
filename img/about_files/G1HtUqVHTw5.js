if (self.CavalryLogger) { CavalryLogger.start_js(["+iYSq"]); }

__d("legacy:animation",["Animation"],(function a(b,c,d,e,f,g){b.Animation=c("Animation")}),3);
__d("ChatInitialDataTransformer.bs",["bs_array","bs_js_dict","getByPath","bs_caml_array","bs_caml_format","messengerMessageTransformerRe","messengerGraphQLThreadFetcherRe","messengerReadReceiptTransformerRe","messengerGraphQLThreadlistFetcherRe"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){__p&&__p();var j=i.viewer,k=+i.is_page,l=[],m=[],n={},o=[],p={},q=[];c("bs_array").iter(function(r){__p&&__p();if(r==null)return 0;else{var s=c("messengerGraphQLThreadFetcherRe").transformThread(j,r,k);l.push(s);var t=r.messages;if(!(t==null))c("bs_array").iter(function(G){m.push(c("messengerMessageTransformerRe").transformMessage(j,G,{thread_id:null,thread_fbid:r.thread_key.thread_fbid,other_user_fbid:r.thread_key.other_user_id,folder:s.folder},k));return 0},t.nodes);var u=c("getByPath")(r,["messages","page_info"]);if(!(u==null))if(!u.has_previous_page){var v=r.thread_key.thread_fbid,w=r.thread_key.other_user_id;if(v==null){if(!(w==null))q.push({type:"thread",fbid:w})}else q.push({type:"thread",fbid:v})}var x=r.read_receipts;if(!(x==null)){var y=c("messengerReadReceiptTransformerRe").transformReadReceipt(j,x),z=r.thread_key.thread_fbid;if(!(z==null))n[z]=y;var A=r.thread_key.other_user_id;if(!(A==null))n[A]=y}var B=r.delivery_receipts;if(!(B==null)){var C=B.nodes.sort(function(G,H){var I=c("bs_caml_format").caml_float_of_string(G.timestamp_precise),J=c("bs_caml_format").caml_float_of_string(H.timestamp_precise);if(I>J)return-1;else if(I===J)return 0;else return 1});if(C.length>=1){var D=c("bs_caml_array").caml_array_get(C,0);if(s.is_canonical){var E=s.other_user_fbid;if(!(E==null))o.push({other_user_fbid:E,thread_fbid:null,time:c("bs_caml_format").caml_float_of_string(D.timestamp_precise)})}else{var F=s.thread_fbid;if(!(F==null))o.push({other_user_fbid:null,thread_fbid:F,time:c("bs_caml_format").caml_float_of_string(D.timestamp_precise)})}}}return c("bs_array").iter(function(G){var H=c("messengerGraphQLThreadlistFetcherRe").transformParticipant(G.messaging_actor);p[H.fbid]=H;return 0},r.all_participants.nodes)}},i.threads);return{threads:l,actions:m,roger:n,delivery_receipts:o,participants:c("bs_js_dict").values(p),end_of_history:q}}g.transform=h}),null);